# æµ‹è¯•ç›®å½•è¯´æ˜

æœ¬ç›®å½•åŒ…å«R3é¡¹ç›®çš„æ‰€æœ‰æµ‹è¯•ä»£ç ï¼ŒæŒ‰åŠŸèƒ½å’Œé˜¶æ®µåˆ†ç±»ç»„ç»‡ã€‚

---

## ç›®å½•ç»“æ„

```
tests/
â”œâ”€â”€ week1/          # Week 1 åŸºç¡€åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ week2/          # Week 2 å……ç”µç«™åŠ¨æ€ä¼˜åŒ–æµ‹è¯•
â”œâ”€â”€ charging/       # å……ç”µç­–ç•¥é›†æˆæµ‹è¯•
â”œâ”€â”€ cost/           # æˆæœ¬è¯„ä¼°æµ‹è¯•
â”œâ”€â”€ debug/          # è°ƒè¯•å·¥å…·å’Œä¸´æ—¶æµ‹è¯•
â””â”€â”€ README.md       # æœ¬æ–‡æ¡£
```

---

## Week 1 æµ‹è¯• (`week1/`)

**ç›®æ ‡**ï¼šéªŒè¯ALNSåŸºç¡€åŠŸèƒ½å’Œå¤šç›®æ ‡æˆæœ¬å‡½æ•°

| æ–‡ä»¶ | æµ‹è¯•å†…å®¹ | æ¨èè¿è¡Œ |
|------|---------|---------|
| `test_task.py` | ä»»åŠ¡åˆ›å»ºå’ŒåŸºæœ¬æ“ä½œ | â­ |
| `test_task_comprehensive.py` | ä»»åŠ¡ç»¼åˆæµ‹è¯•ï¼ˆåˆ›å»ºã€æ’å…¥ã€éªŒè¯ï¼‰ | â­â­ |
| `test_vehicle_route.py` | è½¦è¾†è·¯å¾„æµ‹è¯•ï¼ˆè·ç¦»ã€è´Ÿè½½ã€å¯è¡Œæ€§ï¼‰ | â­â­â­ |
| `test_minimal_alns.py` | ALNSåŸºç¡€åŠŸèƒ½ï¼ˆdestroy/repairï¼‰ | â­â­â­ |
| `test_greedy_to_regret.py` | Greedy vs Regret-2æ€§èƒ½å¯¹æ¯” | â­â­ |
| `test_regret-2.py` | Regret-2ç®—å­å•ç‹¬æµ‹è¯• | â­ |

**å¿«é€ŸéªŒè¯**ï¼š
```bash
python tests/week1/test_vehicle_route.py
python tests/week1/test_minimal_alns.py
```

---

## Week 2 æµ‹è¯• (`week2/`)

**ç›®æ ‡**ï¼šéªŒè¯å……ç”µç«™åŠ¨æ€ä¼˜åŒ–åŠŸèƒ½

| æ–‡ä»¶ | æµ‹è¯•å†…å®¹ | æ¨èè¿è¡Œ |
|------|---------|---------|
| `test_cs_removal.py` | å……ç”µç«™ç§»é™¤ï¼ˆæ­¥éª¤1.1ï¼‰ | â­â­ |
| `test_cs_insertion.py` | å……ç”µç«™æ™ºèƒ½æ’å…¥ï¼ˆæ­¥éª¤1.2ï¼‰ | â­â­ |
| `test_critical_threshold.py` | ä¸´ç•Œå€¼æœºåˆ¶ï¼ˆæ­¥éª¤1.3ï¼‰ | â­â­ |
| `test_alns_dynamic_charging.py` | **ä¸»æµ‹è¯•**ï¼šå®Œæ•´ALNS + FR vs PR-Minimalå¯¹æ¯” | â­â­â­â­â­ |

**ä¸»è¦éªŒè¯ç‚¹**ï¼š
- âœ… Destroyæ“ä½œå¯ä»¥ç§»é™¤å……ç”µç«™
- âœ… Repairæ“ä½œæ™ºèƒ½æ’å…¥å……ç”µç«™
- âœ… ä¸åŒç­–ç•¥äº§ç”Ÿä¸åŒå……ç”µç«™é…ç½®
- âœ… PR-MinimalèŠ‚çœå……ç”µæˆæœ¬16.8%

**å¿«é€ŸéªŒè¯**ï¼š
```bash
# æ¨èï¼šè¿è¡Œä¸»æµ‹è¯•
python tests/week2/test_alns_dynamic_charging.py

# è¯¦ç»†æµ‹è¯•ï¼ˆå•ç‹¬åŠŸèƒ½ï¼‰
python tests/week2/test_cs_removal.py
python tests/week2/test_cs_insertion.py
```

---

## å……ç”µç­–ç•¥æµ‹è¯• (`charging/`)

**ç›®æ ‡**ï¼šå¯¹æ¯”ä¸åŒå……ç”µç­–ç•¥å’Œinsertionæ¨¡å¼

| æ–‡ä»¶ | æµ‹è¯•å†…å®¹ | æ¨èè¿è¡Œ |
|------|---------|---------|
| `test_alns_with_charging_strategies.py` | **3ç§ç­–ç•¥ Ã— 3ç§æ¨¡å¼ = 9ç§ç»„åˆ** | â­â­â­â­ |
| `test_strategy_comparison.py` | å……ç”µç­–ç•¥è¯¦ç»†å¯¹æ¯” | â­â­â­ |
| `test_route_executor.py` | RouteExecutoråŠŸèƒ½æµ‹è¯• | â­â­ |
| `test_physics_integration.py` | ç‰©ç†æ¨¡å‹é›†æˆæµ‹è¯• | â­â­ |

**æµ‹è¯•çŸ©é˜µ**ï¼š
- å……ç”µç­–ç•¥ï¼šFR, PR-Fixed 30%, PR-Minimal 10%
- Insertionæ¨¡å¼ï¼šgreedy, regret2, random
- åœºæ™¯ï¼š12ä¸ªä»»åŠ¡ï¼Œ4ä¸ªå……ç”µç«™ï¼Œ70kWhç”µæ± 

**å¿«é€ŸéªŒè¯**ï¼š
```bash
# 9ç§ç»„åˆå…¨é¢æµ‹è¯•
python tests/charging/test_alns_with_charging_strategies.py

# ç­–ç•¥å¯¹æ¯”
python tests/charging/test_strategy_comparison.py
```

---

## æˆæœ¬è¯„ä¼°æµ‹è¯• (`cost/`)

**ç›®æ ‡**ï¼šéªŒè¯å¤šç›®æ ‡æˆæœ¬å‡½æ•°

| æ–‡ä»¶ | æµ‹è¯•å†…å®¹ | æ¨èè¿è¡Œ |
|------|---------|---------|
| `test_cost_evaluation.py` | æˆæœ¬åˆ†è§£å’Œè®¡ç®—æµ‹è¯• | â­â­â­ |

**éªŒè¯ç‚¹**ï¼š
- è·ç¦»æˆæœ¬è®¡ç®—
- å……ç”µæˆæœ¬è®¡ç®—
- æ—¶é—´æˆæœ¬è®¡ç®—
- å»¶è¿Ÿæƒ©ç½šè®¡ç®—
- ä¸å¯è¡Œæƒ©ç½š

**å¿«é€ŸéªŒè¯**ï¼š
```bash
python tests/cost/test_cost_evaluation.py
```

---

## è°ƒè¯•å·¥å…· (`debug/`)

**ç›®æ ‡**ï¼šè°ƒè¯•å’Œé—®é¢˜åˆ†æå·¥å…·ï¼ˆéæ­£å¼æµ‹è¯•ï¼‰

| æ–‡ä»¶ | ç”¨é€” | ä½•æ—¶ä½¿ç”¨ |
|------|------|---------|
| `check_final_feasibility.py` | æ£€æŸ¥æœ€ç»ˆè§£çš„ç”µæ± å¯è¡Œæ€§ | å‘ç°ä¸å¯è¡Œè§£æ—¶ |
| `debug_pr_minimal_initial.py` | è°ƒè¯•PR-Minimalåˆå§‹è§£ç”Ÿæˆè¿‡ç¨‹ | åˆå§‹è§£ä¸å¯è¡Œæ—¶ |
| `test_charging_calculation.py` | æµ‹è¯•å……ç”µç­–ç•¥è®¡ç®—é€»è¾‘ | å……ç”µé‡å¼‚å¸¸æ—¶ |
| `test_battery_feasibility.py` | æµ‹è¯•ç”µæ± å¯è¡Œæ€§æ£€æŸ¥å‡½æ•° | å¯è¡Œæ€§åˆ¤æ–­é”™è¯¯æ—¶ |

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
# æ£€æŸ¥PR-Minimalæœ€ç»ˆè§£æ˜¯å¦å¯è¡Œ
python tests/debug/check_final_feasibility.py

# é€æ­¥è°ƒè¯•åˆå§‹è§£ç”Ÿæˆ
python tests/debug/debug_pr_minimal_initial.py

# éªŒè¯å……ç”µè®¡ç®—
python tests/debug/test_charging_calculation.py
```

---

## æ¨èæµ‹è¯•æµç¨‹

### 1. åŸºç¡€éªŒè¯ï¼ˆ5åˆ†é’Ÿï¼‰
```bash
# éªŒè¯ALNSåŸºç¡€åŠŸèƒ½
python tests/week1/test_minimal_alns.py

# éªŒè¯Week 2ä¸»è¦åŠŸèƒ½
python tests/week2/test_alns_dynamic_charging.py
```

### 2. å…¨é¢æµ‹è¯•ï¼ˆ15åˆ†é’Ÿï¼‰
```bash
# Week 1
python tests/week1/test_vehicle_route.py
python tests/week1/test_task_comprehensive.py

# Week 2
python tests/week2/test_cs_removal.py
python tests/week2/test_cs_insertion.py
python tests/week2/test_alns_dynamic_charging.py

# å……ç”µç­–ç•¥
python tests/charging/test_alns_with_charging_strategies.py
```

### 3. é—®é¢˜è°ƒè¯•ï¼ˆæŒ‰éœ€ï¼‰
```bash
# å¦‚æœå‘ç°ä¸å¯è¡Œè§£
python tests/debug/check_final_feasibility.py

# å¦‚æœPR-Minimalåˆå§‹è§£å¼‚å¸¸
python tests/debug/debug_pr_minimal_initial.py
```

---

## æµ‹è¯•ç»“æœè§£è¯»

### Week 2ä¸»æµ‹è¯•è¾“å‡ºç¤ºä¾‹

```
======================================================================
å¯¹æ¯”åˆ†æï¼šFR vs PR-Minimal
======================================================================

å……ç”µç«™é…ç½®:
  FR:         1ä¸ªå……ç”µç«™, ä½ç½®: [104]
  PR-Minimal: 1ä¸ªå……ç”µç«™, ä½ç½®: [103]

æˆæœ¬é¡¹             FR                   PR-Minimal           å·®å¼‚              èŠ‚çœ%
-------------------------------------------------------------------------------------
è·ç¦»æˆæœ¬            194142.14            194142.14            0.00            0.0
å……ç”µæˆæœ¬            445.71               370.71               75.00           16.8      âœ“
æ—¶é—´æˆæœ¬            12942.81             12942.81             0.00            0.0
-------------------------------------------------------------------------------------
æ€»æˆæœ¬             207530.66            207455.66            75.00           0.0
```

**å…³é”®æŒ‡æ ‡**ï¼š
- âœ… **å……ç”µæˆæœ¬èŠ‚çœ16.8%**ï¼šPR-Minimalä¼˜åŠ¿æ˜æ˜¾
- âœ… **éƒ½å¯è¡Œ**ï¼šæ— ç”µæ± æƒ©ç½š
- âœ… **å……ç”µç«™ä¸åŒ**ï¼šåŠ¨æ€ä¼˜åŒ–å·¥ä½œæ­£å¸¸

---

## å·²çŸ¥é—®é¢˜ï¼ˆå·²ä¿®å¤ï¼‰

### é—®é¢˜1ï¼šæ—¶é—´æˆæœ¬å•ä½æ··æ·† âœ…
- **ç°è±¡**ï¼šæ—¶é—´æˆæœ¬194142ç§’ï¼ˆ54å°æ—¶ï¼‰
- **åŸå› **ï¼švehicle_speed = 1m/s
- **ä¿®å¤**ï¼švehicle_speed = 15m/s
- **ç»“æœ**ï¼šæ—¶é—´æˆæœ¬12942ç§’ï¼ˆ3.6å°æ—¶ï¼‰

### é—®é¢˜2ï¼šPR-Minimalåˆå§‹è§£ä¸å¯è¡Œ âœ…
- **ç°è±¡**ï¼š100000æƒ©ç½š
- **åŸå› **ï¼š20%ä¸´ç•Œå€¼è¿‡ä¸¥æ ¼
- **ä¿®å¤**ï¼šç¦ç”¨ä¸´ç•Œå€¼ï¼ˆ0%ï¼‰ï¼Œmax_attempts=10
- **ç»“æœ**ï¼šåˆå§‹è§£å¯è¡Œï¼Œæ— æƒ©ç½š

---

## æ·»åŠ æ–°æµ‹è¯•

### æ¨¡æ¿
```python
"""
æµ‹è¯•æè¿°ï¼šç®€è¦è¯´æ˜æµ‹è¯•ç›®çš„
"""

import sys
sys.path.append('src')

from core.node import create_depot
# ... å…¶ä»–å¯¼å…¥

def test_your_feature():
    """æµ‹è¯•ä½ çš„åŠŸèƒ½"""
    print("=" * 70)
    print("æµ‹è¯•ï¼šåŠŸèƒ½åç§°")
    print("=" * 70)

    # 1. åˆ›å»ºæµ‹è¯•åœºæ™¯
    # ...

    # 2. æ‰§è¡Œæµ‹è¯•
    # ...

    # 3. éªŒè¯ç»“æœ
    # assert ...

    # 4. è¾“å‡ºç»“æœ
    print(f"  ç»“æœ: {'âœ“' if success else 'âœ—'}")

if __name__ == "__main__":
    test_your_feature()
```

### æ”¾ç½®ä½ç½®
- **åŸºç¡€åŠŸèƒ½æµ‹è¯•** â†’ `week1/`
- **æ–°åŠŸèƒ½æµ‹è¯•** â†’ å¯¹åº”å‘¨ç›®å½•ï¼ˆå¦‚`week3/`ï¼‰
- **é›†æˆæµ‹è¯•** â†’ `charging/`æˆ–æ–°å»ºç›®å½•
- **ä¸´æ—¶è°ƒè¯•** â†’ `debug/`

---

## ç»´æŠ¤å»ºè®®

1. **å®šæœŸæ¸…ç†**ï¼šåˆ é™¤è¿‡æ—¶çš„debugæ–‡ä»¶
2. **ä¿æŒåˆ†ç±»**ï¼šæ–°æµ‹è¯•æ”¾åˆ°åˆé€‚çš„ç›®å½•
3. **æ›´æ–°æ–‡æ¡£**ï¼šä¿®æ”¹æµ‹è¯•åæ›´æ–°æœ¬README
4. **å‘½åè§„èŒƒ**ï¼š`test_*.py`ï¼Œæè¿°æ€§åç§°

---

**æœ€åæ›´æ–°**ï¼š2025-10-23
**æµ‹è¯•è¦†ç›–**ï¼šWeek 1 âœ… | Week 2 âœ… | Week 3 ğŸ“…
